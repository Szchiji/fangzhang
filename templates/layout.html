<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <style>
        :root { --p: #4361ee; --bg: #f4f7fe; }
        body { background: var(--bg); font-family: 'Inter', sans-serif; }
        .sidebar { background: #fff; border-radius: 16px; height: 90vh; position: sticky; top: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        .nav-link { color: #64748b; padding: 12px; border-radius: 10px; margin-bottom: 5px; transition: 0.3s; }
        .nav-link.active { background: var(--p); color: #fff; box-shadow: 0 4px 12px rgba(67,97,238,0.3); }
        .card { border: none; border-radius: 16px; box-shadow: 0 5px 15px rgba(0,0,0,0.02); }
        #toast-container { position: fixed; top: 20px; right: 20px; z-index: 9999; }
        .toast-msg { background: #2ecc71; color: #fff; padding: 12px 25px; border-radius: 12px; margin-bottom: 10px; animation: slideIn 0.3s forwards; }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }
    </style>
</head>
<body>
    <div id="toast-container"></div>
    <div class="container-fluid py-4 px-md-5">
        <div class="row">
            <div class="col-md-3">{% include 'sidebar.html' %}</div>
            <div class="col-md-9">{% block content %}{% endblock %}</div>
        </div>
    </div>
    <script>
        // AJAX 核心：不刷新保存
        async function ajaxSubmit(formId, url) {
            const form = document.getElementById(formId);
            const fd = new FormData(form);
            if(window.quill) fd.append('content_html', window.quill.root.innerHTML);
            
            try {
                const res = await fetch(url, { method: 'POST', body: fd });
                if(res.ok) showToast("✅ 操作已成功同步");
            } catch { showToast("❌ 网络请求失败", "danger"); }
        }
        function showToast(m, t="success") {
            const el = document.createElement('div');
            el.className = `toast-msg ${t=='danger'?'bg-danger':''}`;
            el.innerText = m;
            document.getElementById('toast-container').appendChild(el);
            setTimeout(() => el.remove(), 3000);
        }
    </script>
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
</body>
</html>
