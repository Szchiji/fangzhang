{% extends "layout.html" %}
{% block content %}
<div class="card-custom">
    <h5 class="fw-bold mb-4">å›å¤æ¨¡æ¿é…ç½® (å¯Œæ–‡æœ¬)</h5>
    
    <div class="mb-4">
        <label class="small fw-bold text-muted mb-3 d-block">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ’å…¥å ä½ç¬¦ï¼š</label>
        <div class="d-flex flex-wrap gap-2 mb-3">
            <button class="btn btn-outline-primary btn-sm rounded-pill" onclick="addTag('{onlineEmoji}')">âœ¨ è¡¨æƒ…</button>
            <button class="btn btn-outline-primary btn-sm rounded-pill" onclick="addTag('{å§“åValue}')">ğŸ‘¤ å§“å</button>
            <button class="btn btn-outline-danger btn-sm rounded-pill" onclick="addTag('{åœ°åŒºValue}')">ğŸ“ åœ°åŒº</button>
        </div>
        
        <div id="editor-container" style="height: 250px;">{{group.list_template|safe}}</div>
    </div>

    <div class="text-end mt-4">
        <button class="btn btn-primary px-5 rounded-pill" onclick="saveData()">ç¡®è®¤ä¿å­˜</button>
    </div>
</div>

<script>
let quill;
document.addEventListener('DOMContentLoaded', () => {
    quill = new Quill('#editor-container', {
        theme: 'snow',
        modules: { toolbar: [['bold', 'italic', 'underline'], [{'color': []}], ['clean']] }
    });
});

function addTag(tag) {
    const range = quill.getSelection(true);
    quill.insertText(range.index, tag, {'bold': true, 'color': '#0d6efd'});
}

async function saveData() {
    const fd = new FormData();
    fd.append('sid', '{{sid}}'); fd.append('gid', '{{gid}}');
    fd.append('list_t', quill.root.innerHTML); // å¯Œæ–‡æœ¬å†…å®¹
    fd.append('check_t', ''); // å¯ä»¥æŒ‰éœ€æ‰©å±•
    fd.append('fields', 'åœ°åŒº,ä»·æ ¼,é“¾æ¥');
    fd.append('emoji', 'âœ…');
    await fetch('/api/save', {method: 'POST', body: fd});
    alert("ä¿å­˜æˆåŠŸï¼");
}
</script>
{% endblock %}
